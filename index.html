<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Logo desde Google Sheet</title>
</head>
<body>
  <h2>Logo desde Google Sheet</h2>
  <img id="logo" alt="Logo de prueba" width="250" />

  <script>
    async function cargarLogo() {
      const sheetId = "1xJEjP9j0ocvG6sob4JfNlQVObK-tT-DY-ubFCAmlsqs"; // ðŸ‘ˆ tu ID correcto
      const sheetName = "Hoja 1";     
      const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;

      try {
        const res = await fetch(url);
        const text = await res.text();

        const json = JSON.parse(text.substr(47).slice(0, -2));
        const filas = json.table.rows;

        const fila = filas[0]; // primera fila
        const logoCrudo = fila.c[1].v;  // Columna B = logo
        console.log("Logo crudo desde la hoja:", logoCrudo);

        // Extraer el fileId de Google Drive
        let fileId = null;
        const match1 = logoCrudo.match(/\/d\/([a-zA-Z0-9_-]+)\//);
        if (match1) fileId = match1[1];
        const match2 = logoCrudo.match(/[?&]id=([a-zA-Z0-9_-]+)/);
        if (match2) fileId = match2[1];

        if (!fileId) throw new Error("No se pudo extraer el fileId del logo");

        const logoFinal = `https://drive.google.com/uc?export=view&id=${fileId}`;
        console.log("Logo final:", logoFinal);

        document.getElementById("logo").src = logoFinal;
      } catch (err) {
        console.error("Error cargando logo:", err);
      }
    }

    cargarLogo();
  </script>
</body>
</html>


