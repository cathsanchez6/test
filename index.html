<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Datos del Cliente</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .cliente { max-width: 600px; margin: auto; }
    img { max-width: 200px; height: auto; display: block; margin-bottom: 20px; }
    h2 { margin-top: 0; }
    p { margin: 5px 0; }
  </style>
</head>
<body>
  <div class="cliente">
    <h1>Datos del Cliente</h1>
    <img id="logo" src="" alt="Logo del cliente">
    <h2 id="razon_social"></h2>
    <p id="sobre_nosotros"></p>
    <p><strong>NIT:</strong> <span id="nit"></span></p>
    <p><strong>Dirección:</strong> <span id="direccion"></span></p>
    <p><strong>Celular:</strong> <span id="celular"></span></p>
    <p><strong>Ciudad:</strong> <span id="ciudad"></span></p>
    <p><strong>Correo electrónico:</strong> <span id="correo_electronico"></span></p>
    <p><strong>Página web:</strong> <span id="pagina_web"></span></p>
  </div>

  <script>
    // Cambia este ID por el cliente que quieras mostrar
    const clienteId = "1"; 

    // URL de tu Apps Script
    const scriptUrl = "https://script.google.com/macros/s/AKfycbxlV7TrJuXTgwOTv4y2LA99t7uFlkuUdKGjsloOR05XCi1nqIw8U1Tuj2haJvvTUDhz5w/exec";

    // Llamada JSONP para obtener datos del cliente
    const callbackName = "mostrarCliente";

    const script = document.createElement('script');
    script.src = `${scriptUrl}?id=${clienteId}&callback=${callbackName}`;
    document.body.appendChild(script);

    function mostrarCliente(data) {
      if (data.error) {
        alert("Error: " + data.error);
        return;
      }

      // Si logo es de Drive, transformar a URL directa
      let logoUrl = data.logo;
      if (logoUrl && logoUrl.includes("drive.google.com")) {
        let fileId = null;
        const match1 = logoUrl.match(/\/d\/([a-zA-Z0-9_-]+)/);
        const match2 = logoUrl.match(/[?&]id=([a-zA-Z0-9_-]+)/);
        if (match1) fileId = match1[1];
        if (match2) fileId = match2[1];
        if (fileId) logoUrl = `https://drive.google.com/uc?export=view&id=${fileId}`;
      }

      document.getElementById("logo").src = logoUrl;
      document.getElementById("razon_social").textContent = data.razon_social;
      document.getElementById("sobre_nosotros").textContent = data.sobre_nosotros;
      document.getElementById("nit").textContent = data.nit;
      document.getElementById("direccion").textContent = data.direccion;
      document.getElementById("celular").textContent = data.celular;
      document.getElementById("ciudad").textContent = data.ciudad;
      document.getElementById("correo_electronico").textContent = data.correo_electronico;
      document.getElementById("pagina_web").textContent = data.pagina_web;
    }
  </script>
</body>
</html>

