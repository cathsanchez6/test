<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Test traer datos</title>
</head>
<body>
  <h1>Logo desde Google Sheet</h1>
  <img id="logo" alt="Logo de prueba" style="max-width:200px; height:auto;" />

  <script>
    const sheetId = "1xJEjP9j0ocvG6sob4JfNlQVObK-tT-DY-ubFCAmlsqs"; 
    const sheetName = "Hoja 1";

    async function cargarLogo() {
      const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;
      const resp = await fetch(url);
      const text = await resp.text();
      console.log("Respuesta cruda:", text);

      const json = JSON.parse(text.substr(47).slice(0, -2));
      console.log("JSON parseado:", json);

      const rows = json.table.rows;
      console.log("Filas:", rows);

      const fila = rows.find(r => r.c && r.c[0]?.v == "1");
      console.log("Fila encontrada:", fila);

      if (fila) {
        let logo = fila.c[1]?.v || "";
        console.log("Logo crudo desde la hoja:", logo);

        // Si el logo es de Drive, transformarlo
        if (logo.includes("drive.google.com")) {
          let fileId = null;
          const match1 = logo.match(/\/d\/([a-zA-Z0-9_-]+)\//);
          if (match1) fileId = match1[1];
          const match2 = logo.match(/[?&]id=([a-zA-Z0-9_-]+)/);
          if (match2) fileId = match2[1];
          if (fileId) logo = `https://drive.google.com/uc?export=view&id=${fileId}`;
        }

        console.log("Logo final:", logo);
        document.getElementById("logo").src = logo;
      }
    }

    cargarLogo();

    // logo contiene la URL en string
    console.log("Asignando src al <img>...");
    document.getElementById("logo").src = logo;
    console.log("src final en el <img>:", document.getElementById("logo").src);


    
  </script>
</body>
</html>

