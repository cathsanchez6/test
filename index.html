<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Logo desde Google Sheet</title>
</head>
<body>
  <h2>Logo desde Google Sheet</h2>
  <img id="logo" alt="Logo de prueba" width="200" />

  <script>
    // ðŸ‘‰ URL de tu Google Sheet publicado como CSV
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-XXX/pub?output=csv";
    
    // FunciÃ³n para convertir un link de Drive a formato directo
    function driveToDirect(url) {
      const match = url.match(/\/d\/(.*)\/view/);
      return match ? `https://drive.google.com/uc?export=view&id=${match[1]}` : url;
    }

    async function cargarLogo() {
      try {
        const res = await fetch(sheetUrl);
        const text = await res.text();

        // Parse CSV simple (solo tomamos primera fila despuÃ©s del encabezado)
        const filas = text.split("\n").map(l => l.split(","));
        const headers = filas[0];
        const datos = filas[1]; // primera fila de datos

        const obj = {};
        headers.forEach((h, i) => {
          obj[h.trim()] = datos[i] ? datos[i].trim() : "";
        });

        console.log("Fila 1 del Sheet:", obj);

        // Convertir logo de Drive
        const logoUrl = driveToDirect(obj.logo);
        console.log("Logo final:", logoUrl);

        // Asignar al <img>
        document.getElementById("logo").src = logoUrl;

      } catch (err) {
        console.error("Error cargando logo:", err);
      }
    }

    cargarLogo();
  </script>
</body>
</html>

</html>

