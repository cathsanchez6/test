<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Logo desde Google Sheet</title>
</head>
<body>
  <h2>Logo desde Google Sheet</h2>
  <img id="logo" alt="Logo de prueba" width="250" />

  <script>
    async function cargarLogo() {
      const sheetId = "https://script.google.com/macros/s/AKfycbzbfYMl6tVNdDlrvnLKL6qkrzk5ZgXDVAGq5I2WH-aYCytYNmh0Q6j0KUgnBqkbV8LpmA/exec"; // ðŸ‘ˆ cambia por tu ID real
      const sheetName = "Hoja 1";     // ðŸ‘ˆ cambia por el nombre de tu hoja
      const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;

      try {
        const res = await fetch(url);
        const text = await res.text();

        // Parsear el JSON
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const filas = json.table.rows;

        // Tomar la primera fila (id=1)
        const fila = filas[0];
        const logoCrudo = fila.c[1].v;  // Columna B = logo
        console.log("Logo crudo desde la hoja:", logoCrudo);

        // Extraer el fileId del link de Drive
        let fileId = null;
        const match1 = logoCrudo.match(/\/d\/([a-zA-Z0-9_-]+)\//);
        if (match1) fileId = match1[1];
        const match2 = logoCrudo.match(/[?&]id=([a-zA-Z0-9_-]+)/);
        if (match2) fileId = match2[1];

        if (!fileId) throw new Error("No se pudo extraer el fileId del logo");

        // Construir la URL directa de Drive
        const logoFinal = `https://drive.google.com/uc?export=view&id=${fileId}`;
        console.log("Logo final:", logoFinal);

        // Asignar al <img>
        document.getElementById("logo").src = logoFinal;
      } catch (err) {
        console.error("Error cargando logo:", err);
      }
    }

    cargarLogo();
  </script>
</body>
</html>


